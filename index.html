<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Solix AI Assistant</title>
<link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet" />
<style>
  :root {
    --primary: #ffd100;
    --bg: #f1f3f4;
    --bot-bg: #fff;
    --user-bg: #fff8e1;
    --text-main: #172b4d;
    --text-sub: #6b778c;
    --font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
    --radius-lg: 16px;
    --radius-sm: 8px;
    --shadow: 0 10px 40px rgba(0,0,0,0.15);
  }
  html, body {
    margin:0; padding:0; width:100%; height:100%;
    background: var(--bg);
    font-family: var(--font-family);
    overscroll-behavior: none;
    overflow: hidden;
  }
  #chatbot {
    position: fixed;
    right: 20px; bottom: 20px;
    width: 420px; max-width: 100vw;
    height: 600px; max-height: 90vh;
    background: var(--bg);
    box-shadow: var(--shadow);
    border-radius: var(--radius-lg);
    display: flex; flex-direction: column; z-index: 9999;
  }
  @media (max-width: 480px) {
    #chatbot { width:100vw; height:80vh; right:0; bottom:0; border-radius:0; box-shadow:none;}
  }
  #header {
    background: var(--primary);
    color: var(--text-main);
    padding: 14px 20px;
    display: flex; align-items: center;
    gap: 12px;
    user-select: none;
    flex-shrink: 0;
  }
  #avatar {
    width: 44px; height: 44px;
    background: rgba(0,0,0,0.1);
    border-radius: 50%;
    font-weight: 700; font-size: 24px;
    display: flex; justify-content: center; align-items: center;
    color: var(--text-main);
    flex-shrink: 0;
  }
  #title {
    font-weight: 700; font-size: 20px; margin:0;
  }
  #messages {
    flex-grow: 1;
    padding: 18px 20px;
    background: var(--bg);
    display: flex; flex-direction: column;
    gap: 12px;
    overflow-y: auto;
    scroll-behavior: smooth;
    overscroll-behavior: contain;
    text-align: left;
  }
  .message {
    max-width: 90%;
    display: flex; flex-direction: column; gap: 4px;
    animation: fadein 0.3s ease forwards;
    opacity: 0;
    transform: translateY(10px);
    text-align: left;
  }
  @keyframes fadein { to { transform:translateY(0); opacity:1; } }
  .bot { align-self: flex-start; }
  .user { align-self: flex-end; }
  .avatar {
    width: 36px; height: 36px; border-radius: 50%;
    display: inline-flex; justify-content: center; align-items: center;
    font-weight: 700; font-size: 18px; user-select: none; margin-right: 8px;
  }
  .avatar.bot { background: var(--primary); color: var(--text-main);}
  .bubble {
    padding: 12px 18px;
    border-radius: var(--radius-lg);
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    word-break: break-word;
    white-space: pre-wrap;
    user-select: text;
    background: var(--bot-bg);
    color: var(--text-main);
    border-bottom-left-radius: var(--radius-sm);
    border-top-left-radius: var(--radius-lg);
    border-top-right-radius: var(--radius-lg);
    text-align: left;
  }
  .user .bubble {
    background: var(--user-bg);
    border-bottom-right-radius: var(--radius-sm);
    border-top-left-radius: var(--radius-lg);
    border-top-right-radius: var(--radius-lg);
    font-weight: 600;
  }
  .timestamp {
    font-size: 11px; color: var(--text-sub); user-select: none; white-space: nowrap; 
    padding-left: 44px; text-align: left;
  }
  .user .timestamp { padding-left: 0; padding-right: 44px; }
  .chips {
    margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap;
  }
  button.chip {
    background: var(--user-bg); border: none; border-radius: 20px;
    padding: 6px 14px; font-weight: 600; color: var(--text-main); cursor: pointer;
    user-select: none; white-space: nowrap; transition: background-color 0.3s ease;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05); font-size: 14px;
  }
  button.chip:hover {
    background: var(--primary); color: var(--text-main);
  }
  #inputArea { padding: 14px 20px; background: #fff; border-top: 1px solid #dde1e6; flex-shrink: 0;}
  form {display: flex; gap: 12px;}
  input[type="text"] {
    flex-grow: 1; font-size: 14px; padding: 12px 18px; border-radius: 20px;
    border: 1px solid #ccc; color: var(--text-main); font-family: var(--font-family);
    outline: none; transition: border-color 0.25s ease;
  }
  input[type="text"]:focus { border-color: var(--primary); box-shadow: 0 0 8px rgba(255,209,0,0.6);}
  input::placeholder { color: var(--text-sub); font-weight: 400;}
  button#sendBtn {width:44px;height:44px;border-radius:50%;background:var(--primary);border:none;font-weight:700;font-size:20px;color:var(--text-main);cursor:pointer;display:flex;justify-content:center;align-items:center;user-select:none;transition:background-color 0.2s;}
  button#sendBtn:disabled {opacity: 0.6;cursor: default;background: #ccc;color: #888;}
  button#sendBtn:not(:disabled):hover {background: #d4b300;}
  a.link { color: var(--primary);text-decoration: underline;user-select:auto;}
  a.link:hover { color: #d4b300; }
  a.calendly-link { display:inline-block;padding:6px 18px;margin-top:8px;background:var(--primary);color:var(--text-main);font-weight:600;text-decoration:none;border-radius:var(--radius-sm);user-select:auto;transition:background-color 0.2s;}
  a.calendly-link:hover {background-color:#d4b300;}
</style>
</head>
<body>
<div id="chatbot" role="region" aria-label="Solix AI Assistant chat widget">
  <header id="header">
    <div id="avatar" aria-hidden="true">S</div>
    <h1 id="title">Solix AI Assistant</h1>
  </header>
  <main id="messages" aria-live="polite" aria-atomic="false"></main>
  <section id="inputArea">
    <form id="inputForm" aria-label="Chat message input form" autocomplete="off">
      <input type="text" id="inputField" placeholder="Ask about Coen's skills, projects or services..." aria-label="Message input" required />
      <button type="submit" id="sendBtn" aria-label="Send message" disabled>âž¤</button>
    </form>
  </section>
</div>
<script>
(() => {
  // Centralized buttons to always offer (can be changed)
  const defaultChipsEn = [
    "Tell me about Coen's services",
    "Describe Coen's product owner experience",
    "Tell me about Coen's agile coaching",
    "List Coen's key projects",
    "Book a call",
    "Contact Coen"
  ];
  const defaultChipsNl = [
    "Vertel over Coens diensten",
    "Vertel over Coens Product Owner ervaring",
    "Vertel over Coens agile coaching",
    "Noem Coens belangrijkste projecten",
    "Plan een gesprek",
    "Contacteer Coen"
  ];
  const dataset = {
    en: {
      title: "Solix AI Assistant",
      placeholder: "Ask about Coen's skills, projects or services...",
      welcome: {
        text:"Hello! I'm Coen Zweers' AI assistant. Ask me about his experience, projects, certifications, or services.",
        chips: defaultChipsEn,
        langSwitcher: { lang: "nl", text: "ðŸ‡³ðŸ‡± Switch to Dutch" }
      },
      intents: [
        { id: "services", keywords: ["service", "offer", "help", "what do you do"], response: { text:`Coen Zweers offers consultancy in renewable energy, finance, and technology. His main services include strategic consultancy, interim management, agile coaching, product ownership, and project management.` }},
        { id: "product_owner", keywords: ["product owner", "product manager", "backlog", "jira", "figma", "pspo"], response: { text:`Coen has led product ownership roles at Sunrock and Rabobank, managing backlogs in Jira and designing digital tools in Figma. He's certified PSPO II.` }},
        { id: "agile", keywords: ["agile", "scrum", "scrum master", "psm", "coach"], response: { text:`At ABN AMRO, Coen coached multiple teams as an Agile Coach and Scrum Master, implementing Scrum frameworks and agile mindsets. Certified PSM II and SAFe Agilist.` }},
        { id: "projects", keywords: ["project", "elipslife", "erp", "kramp", "sunrock", "rabobank", "accenture"], response: { text:`Coen's notable projects include ERP implementation at elipsLife, transformation PMO at Kramp, digital solar solutions at Sunrock, and AI automation at Rabobank and Accenture.` }},
        { id: "contact", keywords: ["contact", "call", "book", "schedule", "appointment", "talk", "meeting"], response: { text:`Schedule an introductory call: <a href="https://calendly.com/coenzers-solix/introduction" target="_blank" class="calendly-link">Book a call</a><br>Or email: <a href="mailto:coenzers@solix.cc" class="link">coenzers@solix.cc</a>` }}
      ],
      fallback: { 
        generic: { text:`Sorry, I donâ€™t have the answer. You can <a href="https://calendly.com/coenzers-solix/introduction" target="_blank" class="calendly-link">book a call</a> or email <a href="mailto:coenzers@solix.cc" class="link">coenzers@solix.cc</a>.` } 
      }
    },
    nl: {
      title: "Solix AI Assistent",
      placeholder: "Vraag over Coens ervaring, projecten of diensten...",
      welcome: {
        text:"Hallo! Ik ben de AI-assistent van Coen Zweers. Stel me vragen over zijn ervaring, certificeringen en diensten.",
        chips: defaultChipsNl,
        langSwitcher: { lang: "en", text: "ðŸ‡¬ðŸ‡§ Switch naar Engels" }
      },
      intents: [
        { id: "services", keywords: ["dienst", "aanbod", "hulp", "wat doe je"], response: { text:`Coen Zweers biedt consultancy in hernieuwbare energie, financiÃ«n en technologie. Zijn diensten omvatten strategisch advies, interim management, agile coaching, product ownership en projectmanagement.` }},
        { id: "product_owner", keywords: ["product owner", "product manager", "backlog", "jira", "figma", "pspo"], response: { text:`Coen heeft leiding gegeven aan product ownerschap bij Sunrock en Rabobank, beheert backlogs in Jira en ontwerpt tools in Figma. Gecertificeerd PSPO II.` }},
        { id: "agile", keywords: ["agile", "scrum", "scrum master", "coach", "psm"], response: { text:`Bij ABN AMRO heeft Coen teams begeleid als Agile Coach en Scrum Master, met Scrum en agile methodes. Gecertificeerd PSM II en SAFe Agilist.` }},
        { id: "projects", keywords: ["project", "elipslife", "erp", "kramp", "sunrock", "rabobank", "accenture"], response: { text:`Belangrijke projecten zijn ERP-implementatie bij elipsLife, PMO transformatie bij Kramp, digitale zonne-energie oplossingen bij Sunrock en AI automatisering bij Rabobank en Accenture.` }},
        { id: "contact", keywords: ["contact", "gesprek", "afspraak", "plan", "boek", "bel", "kennismaking"], response: { text:`Kennismaken? <a href="https://calendly.com/coenzers-solix/introduction" target="_blank" class="calendly-link">Plan een gesprek</a><br>Of e-mail: <a href="mailto:coenzers@solix.cc" class="link">coenzers@solix.cc</a>` } }
      ],
      fallback: { generic: { text:`Sorry, ik heb het antwoord niet. Plan een gesprek via: <a href="https://calendly.com/coenzers-solix/introduction" target="_blank" class="calendly-link">Plan een gesprek</a> of mail naar: <a href="mailto:coenzers@solix.cc" class="link">coenzers@solix.cc</a>.` } }
    }
  };
  let currentLang = navigator.language.startsWith("nl") ? "nl" : "en";

  const messages = document.getElementById("messages");
  const form = document.getElementById("inputForm");
  const input = document.getElementById("inputField");
  const title = document.getElementById("title");
  const sendBtn = document.getElementById("sendBtn");

  function escapeHTML(text) {
    return text.replace(/[&<>"']/g, c => ({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[c]));
  }

  function setLanguage(lang){
    currentLang = lang;
    const T = dataset[lang];
    title.textContent = T.title;
    input.placeholder = T.placeholder;
    messages.innerHTML = "";
    appendMessage("bot", T.welcome.text, getExtendedChips(T.welcome.chips));
  }

  function findIntent(text){
    text = text.toLowerCase();
    let intents = dataset[currentLang].intents;
    for(const intent of intents){
      if(intent.keywords.some(kw => text.includes(kw))) return intent;
    }
    return null;
  }

  // Always suggest core chips after every answer
  function getExtendedChips(chips){
    return Array.from(new Set([...(chips||[]), ...(currentLang==="en"?defaultChipsEn:defaultChipsNl)]));
  }

  function getResponseFor(text){
    const intent = findIntent(text);
    if(intent) {
      return {text: intent.response.text, chips: getExtendedChips(intent.response.chips)};
    }
    let fallback = dataset[currentLang].fallback.generic;
    return {text: fallback.text, chips: getExtendedChips(fallback.chips)};
  }

  function appendMessage(sender, html, chipsList){
    const wrapper = document.createElement("div");
    wrapper.className = `message ${sender}`;
    wrapper.style.textAlign = "left";
    if(sender === "bot") {
      let avatar = document.createElement("div");
      avatar.className = "avatar bot";
      avatar.innerHTML = "S";
      wrapper.appendChild(avatar);
    }
    const bubble = document.createElement("div");
    bubble.className = `bubble ${sender}`;
    bubble.innerHTML = html;
    wrapper.appendChild(bubble);

    if (chipsList && chipsList.length){
      const chipsDiv = document.createElement("div");
      chipsDiv.className = "chips";
      chipsList.forEach(text => {
        const chipButton = document.createElement("button");
        chipButton.className = "chip";
        chipButton.type = "button";
        chipButton.textContent = text;
        chipButton.onclick = () => {
          appendMessage("user", escapeHTML(text), chipsList);
          handleUserInput(text);
        };
        chipsDiv.appendChild(chipButton);
      });
      wrapper.appendChild(chipsDiv);
    }
    const time = document.createElement("div");
    time.className = "timestamp";
    time.textContent = new Date().toLocaleTimeString([], {hour:"2-digit", minute:"2-digit"});
    wrapper.appendChild(time);
    messages.appendChild(wrapper);
    messages.scrollTop = messages.scrollHeight;
  }

  function handleUserInput(text){
    setTimeout(()=>{
      const response = getResponseFor(text);
      appendMessage("bot", response.text, response.chips);
    }, 500);
  }

  input.addEventListener("input", () => {
    sendBtn.disabled = input.value.trim() === "";
  });

  form.addEventListener("submit", e => {
    e.preventDefault();
    if(input.value.trim() === "") return;
    appendMessage("user", escapeHTML(input.value.trim()));
    handleUserInput(input.value.trim());
    input.value = "";
    sendBtn.disabled = true;
  });

  document.addEventListener("DOMContentLoaded", () => {
    setLanguage(currentLang);
    input.focus();
  });
})();
</script>
</body>
</html>
